<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera App</title>
</head>
<body>
    <canvas id="cameraCanvas" width="640" height="480" style="border: 2px solid red;"></canvas>
    <button id="captureButton">Take Photo</button>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const cameraCanvas = document.getElementById('cameraCanvas');
            const captureButton = document.getElementById('captureButton');

            let videoStream;
            let context = cameraCanvas.getContext('2d');

            // Function to initialize the camera stream
            function initCamera() {
                navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'environment' // Use the back camera
                    }
                })
                .then(function (stream) {
                    videoStream = stream;
                    cameraCanvas.width = stream.getVideoTracks()[0].getSettings().width || 640;
                    cameraCanvas.height = stream.getVideoTracks()[0].getSettings().height || 480;

                    // Attach the camera stream to the video element
                    const video = document.createElement('video');
                    video.srcObject = stream;
                    video.play();

                    // Draw the camera stream onto the canvas
                    function draw() {
                        context.drawImage(video, 0, 0, cameraCanvas.width, cameraCanvas.height);
                        requestAnimationFrame(draw);
                    }
                    draw();
                })
                .catch(function (error) {
                    console.error('Error accessing the camera: ', error);
                });
            }

            // Ask for camera permission when the page loads
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                initCamera();
            } else {
                console.error('getUserMedia is not supported on this browser');
            }

            // Function to capture a photo
            function capture() {
                if (videoStream) {
                    context.drawImage(videoStream.getVideoTracks()[0].getSettings().width || 640,
                        videoStream.getVideoTracks()[0].getSettings().height || 480);
                }
            }

            // Attach the capture function to the button click event
            captureButton.addEventListener('click', capture);
        });
    </script>
</body>
</html>
